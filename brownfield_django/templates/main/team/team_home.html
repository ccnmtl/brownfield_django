{% extends 'base.html' %}
{% load static %}
{% load waffle_tags %}

{% block content %}
    <h2>
        {{object.course}}
    </h2>

    <div class="course-message">
        <h3>Course Message</h3>
        {{object.course.message}}
    </div>

    <div class="team-div">
        <h3>Team Information</h3>

        <div class="team-div-info-1">
            <b>Team Name: </b> {{object.user.username}} <br />
            <b>Course: </b> {{object.course}} <br />
        </div>
        <div class="team-div-info-2">
            <b>Signed Contract: </b> <span class="contract-status"> {{object.signed_contract}} </span> <br />
            <b>Budget: </b> {{object.budget}} <br />
        </div>

        <div class="team-div-info-2">
            <a class="btn btn-default" href="/team_csv/{{ request.user.id }}/">
                <span class="glyphicon glyphicon-usd"></span> Download Team Budget History (CSV)
            </a>
            <a class="btn btn-default" href="{% static 'flash/documents/slMap.pdf' %}" target="_blank">
                <span class="glyphicon glyphicon-th"></span> Download Map (PDF)
            </a>
            <a class="btn btn-default" href="{% static 'flash/documents/contract.pdf' %}" target="_blank">
                <span class="glyphicon glyphicon-pencil"></span> Download Contract (PDF)
            </a>
        </div>
    </div>
    <div class="course-div">
        <h3>Course Documents</h3>
        <div class="course-docs">
        {% for document in document_list %}
            <li><a href="{{document.link}}" target="_blank">{{ document.name }}</a></li>
        {% empty %}
            <li>Sorry, no documents have been made available yet.</li>
        {% endfor %}
        </div>
    </div>

    <div class='course-header'>
        <h3>PLAY BROWNFIELD ACTION</h3>
        <div class="pull-right">
            <a class="btn btn-info btn-sm " role="button" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Help
            </a>
            {% flag 'html5' %}
            <a class="btn btn-success btn-sm" role="button"
                href="{% url 'team-home-html5' object.pk %}">
                <span class="glyphicon glyphicon-gift" aria-hidden="true"></span> Beta Simulation
            </a>
            {% endflag %}
        </div>
        <div class="clearfix"></div>
        <div class="collapse" id="collapseExample">
            <div class="well">
                The Adobe® Flash® Player is required to run the Brownfield Action
                interactive experience. For more information on installing
                and enabling Flash in your browser, please
                refer to the Adobe <a href="https://helpx.adobe.com/flash-player.html" target="_blank">Flash Player Help</a> page.
            </div>
        </div>
    </div>

    {% if object.signed_contract == False %}
        <p>
            You must sign the contract to play the game. Read through the contract
            below, then click <strong>Sign Contract</strong> to continue.
        </p>
        <iframe src="{% static 'flash/documents/contract.pdf' %}" style="width:100%; height: 400px"></iframe>
        <form method="post" action="{% url 'sign-contract' %}">{% csrf_token %}
            <input type="hidden" name="next" value="{% url 'team-home' object.pk %}" />
            <button type="submit" class="btn btn-primary">Sign Contract</button>
        </form>
    {% else %}
        <div class="show-game">
            <div class="play-brownfield">
                <div id="main_content">
                    <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
                        codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0"
                            width="761" height="521" id="bfa" align="middle">
                        <param name="allowScriptAccess" value="sameDomain" />
                        <!-- Static -->
                        <param name="movie"
                            value="{% static 'flash/bfa.swf' %}" />

                        <param name="quality" value="high" />
                        <param name="bgcolor" value="#4d3e1b" />

                        <!-- Domain & Static Do I need site.domain in front of static url?-->
                        <param name="flashVars"
                            value="serverURL={{site.domain}}../../../team/{{object.pk}}/&amp;resourceRootURL={% static 'flash/' %}" />

                        <!-- Static & Plugins & Domain & Static -->
                        <embed src="{% static 'flash/bfa.swf' %}" quality="high" bgcolor="#4d3e1b" width="761"
                          height="521" name="bfa" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash"
                          pluginspage="http://www.macromedia.com/go/getflashplayer"
                          flashVars="serverURL={{site.domain}}../../../team/{{object.pk}}/&amp;resourceRootURL={% static 'flash/' %}" />
                    </object>
                </div>
            </div>
            <div>
                <h3>Document Downloads</h3>
                <ul>
                    <li><a href="{% static 'flash/documents/slCatalog.pdf' %}" target="_blank">Self-Lume catalog</a></li>
                    <li><a href="{% static 'flash/documents/slBrochure.pdf' %}" target="_blank">Self-Lume brochure</a></li>
                    <li><a href="{% static 'flash/documents/slMap.pdf' %}" target="_blank">Self-Lume property map</a></li>
                    <li><a href="{% static 'flash/documents/contract.pdf' %}" target="_blank">Copy of contract text</a></li>
                </ul>
            </div>
        </div><!-- End show game -->

    {% endif %}
{% endblock %}<!-- End Content Block -->
